# Pod 资源亲和调度

Pod 对象间亲和性，将一些 Pod 对象组织在相近的位置(同一节点、机架、区域、地区)Pod 对象间反亲和性，将一些 Pod 在运行位置上隔开

### Pod 硬亲和调度

requiredDuringSchedulingIgnoredDuringExecution

Pod 亲和性描述一个 Pod 与具有某特征的现存 Pod 运行位置的依赖关系；即需要事先存在被依赖的 Pod 对象

```yaml
# 被依赖 Pod
kubectl run tomcat-1 app=tomcat--image tomcat:alpine
kubectl explain
pod.spec.affinity.podAffinity.requiredDuringSchedulingIgnoredDuringExecution.to pologyKey

apiVersion:v1
kind:Pod
metadata:
  name:with-pod-affinity
spec:
  affinity:
    podAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:# 硬亲和调度
      - labelSelector:
        matchExpressions:#集合选择器
        -{key:app,operator:In,values:["tomcat"]}# 选择被依赖 Pod
# 上面意思是，当前 pod 要跟标签为 app 值为 tomcat 的 pod 在一起
        topologyKey:kubernetes.io/hostname# 根据挑选出的 Pod 所有节点的 hostname
作为同一位置的判定
  containers:
  - name:myapp
    image:ikubernetes/myapp:v1
```

